<?php

require "res/Services/Twilio.php";
require "globals.php";

// State start implementation


	header("content-type: text/xml");

	
	// Update of the value of the global constants and variables, and the session params.
	
	
	if($_REQUEST["CallStatus"]=="in-progress"|| $_REQUEST["CallStatus"]=="ringing" ){
		
	
		// Initialitation of the global variables
	
	
		// Declaration of the statements of the state.
		echo "<?xml version=\"1.0\" encoding=\"UTF-8\"?> ";
		echo "<Response>";
if(($_REQUEST['From']=="+34656422095")){
		echo "<Say voice=\"man\" language=\"en\">"."Hello Peter!. We was waiting for you."."</Say>\n" ;
echo "<Hangup /> \n" ;
		}
else {
		echo "<Say voice=\"man\" language=\"en\">"."sorry, we are busy. Bye"."</Say>\n" ;
echo "<Hangup /> \n" ;
		}
	
	
		// Update the global variables and the session params.
	
	
		echo "</Response>";
	}
	
	
	
	
	$_REQUEST['lastState']='start';
	
?>