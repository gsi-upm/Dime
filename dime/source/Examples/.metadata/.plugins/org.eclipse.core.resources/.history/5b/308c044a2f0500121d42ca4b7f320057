Application Restaurant  

String  hour;
String day;
String month;  
String people;			

State start  {
	
	Say "Bienvenido al servicio de atencion especial de restaurantes de Telcodev.";
	Ask 'Usted desea solicitar reserva en uno de nuestros restaurantes. Es correcto?';
	GoTo isclient when COMPLETED;
	
	
} 

State isclient times 3 {

	if(ANSWER=="yes"){
		Say "De acuerdo. Ahora procederemos a la realizacion de la solicitud. ";
		Ask "Diga el numero de comensales";
		GoTo askpeople when COMPLETED;
	}else{
		Say "De acuerdo, disculpe las molestias que le hayamos ocasionado. Un saludo.";
		HangUp;
	}
	GoTo tooattempts when TIMES;
	GoTo hanguperror when ERROR;
}

State askpeople times 3 {
	
	GoTo askday when COMPLETED;
	GoTo tooattempts when TIMES;
	GoTo hanguperror when ERROR;
}

State askday times 3 {
	Ask "En que dia lo desea?" ;
	
	GoTo askmonth when COMPLETED;
	GoTo tooattempts when TIMES;
	GoTo hanguperror when ERROR;
}

State askmonth times 3 {
	Ask "En que mes desea realizar dicha reserva?" ;
	
	GoTo askhour when COMPLETED;
	GoTo tooattempts when TIMES;
	GoTo wrongchoice when ERROR;
	GoTo hanguperror when ERROR;
}


State askhour times 3 {
	Ask "A que hora le conviene?" ;
	
	GoTo askdone when COMPLETED;
	GoTo tooattempts when TIMES;
	GoTo wrongchoice when ERROR;
	GoTo hanguperror when ERROR;
}
State askdone times 3 {
	Say 'Usted ha solicitado una reserva en nuestro restaurante el dia '.day.'de'.month.'de'."2012".'a las '.hour." para".people.' personas.';
	Ask "Esta totalmente de acuerdo con dicha solicitud?";
	if(ANSWER=="yes"){
		GoTo hangup when COMPLETED;
	}else{
		GoTo modification when COMPLETED;
	}
	GoTo tooattempts when TIMES;
	GoTo wrongchoice when ERROR;
	GoTo hanguperror when ERROR;
}

State modification times 3 {
	Ask "Que dato desea modificar?" ;
	if(ANSWER=="numero de comensales"){
		GoTo askpeople when COMPLETED;
	}else if(ANSWER=="dia"){
		GoTo askday when COMPLETED;
	}
	else if(ANSWER=="hora"){
		GoTo askhour when COMPLETED;
	}else{
		GoTo askmonth when COMPLETED;
	}
	
	GoTo tooattempts when TIMES;
	GoTo wrongchoice when ERROR;
	GoTo hanguperror when ERROR;
}

State tooattempts {
	Say "Disculpe, pero estamos teniendo problemas para entender. Si es tan amable intentelo m‡s tarde";
}

State hanguperror {
	Say "Ha ocurrido un error, disculpe las molestias.";
}

State wrongchoice{
	if(LASTSTATE=="askDay"){
		Say  "Lo siento, no le hemos entendido. Tiene que decir un dia del mes";
		GoTo askday when COMPLETED;
	}else if(LASTSTATE=="askHour"){
		Say "Lo siento, no le hemos entendido. Diga la hora a la que quiere hacer la reserva. Solo es posible hacer una reserva a las horas en punto o y media entre la una y las 11 y media de la noche.";
		GoTo askhour when COMPLETED;
	}
	else if(LASTSTATE=="askPeople"){
		Say "Lo siento, no le hemos entendido. Sepa ademas que el numero maximo de comensales es 10";
		GoTo askpeople when COMPLETED;
	}else if (LASTSTATE=="askMonth"){
		GoTo askmonth when COMPLETED;
	}else if(LASTSTATE=="askDone"){
		Say "Perdone, no le hemos entendido";
		GoTo askdone when COMPLETED;
	}else if(LASTSTATE=="confirmation"){
		Say "Lo siento, no le hemos entendido. Los datos a modificar son: numero de comensales, mes, dia y hora de la reserva";
		GoTo modification when COMPLETED;
		
	}else{ 
		Say "Perdone, no le hemos entendido";
		GoTo isclient when COMPLETED;
	}
}    
 
State hangup {
	Say "De acuerdo. Gracias por utilizar nuestro servicio de restaurantes Telcodev. Un saludo.";
	
	
	Send { "caller": CALLER, "day": day, "hour": hour, "month": month, "people": people} to "http://www.restaurant.com";
	HangUp;
}