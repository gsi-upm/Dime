Application Restaurant  

String  hour;
String day;
String month;  
String people;			

State start  {
	
	Say "Bienvenido al servicio de atencion especial de restaurantes de Telcodev.";
	GoTo isClient when COMPLETED;
	
} 

State isClient times 3 {

	Ask 'Usted desea solicitar reserva en uno de nuestros restaurantes. Es correcto?' -> client;
	
	if(client=="yes"){
		say "De acuerdo. Ahora procederemos a la realizacion de la solicitud. ";
		goTo askPeople when complete;
	}else{
		say "De acuerdo, disculpe las molestias que le hayamos ocasionado. Un saludo.";
		hangUp;
	}
	goTo tooAttempts when attemptsLimit;
	goTo wrongChoice when incomplete;
	goTo hangUpError when error;
}
state askPeople times 3 {
	ask "Diga el numero de comensales" choices "1,2,3,4,5,6,7,8,9,10" -> people;
	
	goTo askDay when complete;
	goTo tooAttempts when attemptsLimit;
	goTo wrongChoice when incomplete;
	goTo hangUpError when error;
	}

state askDay times 3 {
	ask "En que dia lo desea?" choices "1,2,3,4,5,6,7,8,9,10" -> people;
	
	goTo askMonth when complete;
	goTo tooAttempts when attemptsLimit;
	goTo wrongChoice when incomplete;
	goTo hangUpError when error;
}

state askMonth times 3 {
	ask "En que mes desea realizar dicha reserva?" choices "1enero, febrero, marzo, abril, mayo, junio, julio, agosto, septiembre, octubre, noviembre, diciembre" -> people;
	
	goTo askHour when complete;
	goTo tooAttempts when attemptsLimit;
	goTo wrongChoice when incomplete;
	goTo hangUpError when error;
}


state askHour times 3 {
	ask "A que hora le conviene?" choices "una, una y media, dos" -> people;
	
	goTo askDone when complete;
	goTo tooAttempts when attemptsLimit;
	goTo wrongChoice when incomplete;
	goTo hangUpError when error;
}
state askDone times 3 {
	say 'Usted ha solicitado una reserva en nuestro restaurante el dia '.day.'de'.month.'de'."2012".'a las '.hour." para".people.' personas.';
	ask "Esta totalmente de acuerdo con dicha solicitud?" choices "si,no" -> isDone;
	if(isDone=="yes"){
		goTo hangUp when complete;
	}else{
		goTo modification when complete;
	}
	goTo tooAttempts when attemptsLimit;
	goTo wrongChoice when incomplete;
	goTo hangUpError when error;
}

state modification times 3 {
	ask "Que dato desea modificar?" choices "numero de comensales, mes, dia, hora" -> toModify;
	if(toModify=="numero de comensales"){
		goTo askPeople when complete;
	}else if(toModify=="dia"){
		goTo askDay when complete;
	}
	else if(toModify=="hora"){
		goTo askHour when complete;
	}else{
		goTo askMonth when complete;
	}
	
	goTo tooAttempts when attemptsLimit;
	goTo wrongChoice when incomplete;
	goTo hangUpError when error;
}

state tooAttempts {
	say "Disculpe, pero estamos teniendo problemas para entender. Si es tan amable intentelo m‡s tarde";
}

state hangUpError {
	say "Ha ocurrido un error, disculpe las molestias.";
}

state wrongChoice{
	if(lastState=="askDay"){
		say  "Lo siento, no le hemos entendido. Tiene que decir un dia del mes";
		goTo askDay when complete;
	}else if(lastState=="askHour"){
		say "Lo siento, no le hemos entendido. Diga la hora a la que quiere hacer la reserva. Solo es posible hacer una reserva a las horas en punto o y media entre la una y las 11 y media de la noche.";
		goTo askHour when complete;
	}
	else if(lastState=="askPeople"){
		say "Lo siento, no le hemos entendido. Sepa ademas que el numero maximo de comensales es 10";
		goTo askPeople when complete;
	}else if (lastState=="askMonth"){
		goTo askMonth when complete;
	}else if(lastState=="askDone"){
		say "Perdone, no le hemos entendido";
		goTo askDone when complete;
	}else if(lastState=="confirmation"){
		say "Lo siento, no le hemos entendido. Los datos a modificar son: numero de comensales, mes, dia y hora de la reserva";
		goTo modification when complete;
		
	}else{ 
		say "Perdone, no le hemos entendido";
		goTo isClient when complete;
	}
}    
 
state hangUp {
	say "De acuerdo. Gracias por utilizar nuestro servicio de restaurantes Telcodev. Un saludo.".day;
	varString reservation= "caller=".caller." ,"." day=".day.","." hour=".hour.","." month=".month;
	
	send { "caller"=>caller, "day"=>day, "hour"=> hour, "month"=> month, "people"=>people} to "http://www.restaurant.com";
	
	
	hangUp;
}