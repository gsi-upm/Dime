Application Restaurant  

String hour;
String day;
String month;  
String people;		
Const usernumber="+34656422095";	
Const userEmail="totemteleko@gmail.com";
Const year= 2012;
State START  {  
	Say "Bienvenido al servicio de atencion especial de restaurantes de Telcodev.";
	GoTo ISCLIENT when COMPLETED;    
}   

State ISCLIENT {
	Say 'Usted desea solicitar reserva en uno de nuestros restaurantes. Es correcto? Pulse 1 si esta conforme o 0 si no lo esta.';
	Get 1 digits;
	GoTo CLIENTCONF when COMPLETED;
	GoTo HANGUPERROR when ERROR;
}
 
State CLIENTCONF times 3 {

	if(DIGITS==1){
		Say "De acuerdo. Ahora procederemos a la realizacion de la solicitud. ";
		GoTo ASKPEOPLE when COMPLETED;
	}else if(DIGITS==0){
		Say "De acuerdo, disculpe las molestias que le hayamos ocasionado. Un saludo.";
		HangUp;
	}else{
		GoTo ISCLIENT when COMPLETED;
	}
	GoTo TOOATTEMPTS when TIMES;
	GoTo HANGUPERROR when ERROR;
}

State ASKPEOPLE {
	Say "Diga el numero de comensales";
	Get 1 digits;
	if(TIMES==0){
		GoTo ASKDAY when COMPLETED;
	}else{
		GoTo ASKDONE when COMPLETED;
	}
	GoTo HANGUPERROR when ERROR;
}

State ASKDAY{
	String people=DIGITS;
	Say "En que dia lo desea?" ;
	Get 2 digits;
	if(TIMES==0){
		GoTo ASKMONTH when COMPLETED;
	}else{
		GoTo ASKDONE when COMPLETED;
	}
	
	GoTo HANGUPERROR when ERROR;
}

State ASKMONTH {
	String day=DIGITS;
	Say "En que mes desea realizar dicha reserva?" ;
	Get 1 digits;
	if(TIMES==0){
		GoTo ASKHOUR when COMPLETED;
	}else{
		GoTo ASKDONE when COMPLETED;
	}
	GoTo HANGUPERROR when ERROR;
}


State ASKHOUR {
	String month=DIGITS;
	Say "A que hora le conviene?" ;
	Get 4 digits;
	GoTo ASKDONE when COMPLETED;
	GoTo HANGUPERROR when ERROR;
} 
State ASKDONE  {
	String hour=DIGITS;
	Say 'Usted ha solicitado una reserva en nuestro restaurante el dia '.day.'de'.month.'de'."2012".'a las '.hour." para".people.' personas.';
	Say "Esta totalmente de acuerdo con dicha solicitud? Pulse 1 si esta conforme, o 0 si no lo esta.";
	Get 1 digits;
	GoTo DONECONF when COMPLETED;
}
 
State DONECONF times 3{
	if(DIGITS==1){
		GoTo END when COMPLETED;
	}else if(DIGITS==0){
		Say "Que dato desea modificar?";
		Say "Pulse 1 para el numero de comensales.";
		Say "Pulse 2 para el dia";
		Say "Pulse 3 para el mes";
		Say "Pulse 4 para la hora";
		Get 1 digits;
		GoTo MODIFICATION when COMPLETED;
	}
	GoTo TOOATTEMPTS when TIMES;
	GoTo HANGUPERROR when ERROR;
}
State MODIFICATION times 3 {
	
	if(DIGITS==1){
		GoTo ASKPEOPLE when COMPLETED;
	}else if(DIGITS==2){
		GoTo ASKDAY when COMPLETED;
	}
	else if(DIGITS==3){
		GoTo ASKMONTH when COMPLETED;
	}
	else if(DIGITS==4){
		GoTo ASKHOUR when COMPLETED;
	}else{
		Say "Disculpe, pero ha pulsado un digito equivocado.";
		GoTo DONECONF when COMPLETED;
	}
	
	GoTo TOOATTEMPTS when TIMES;
	GoTo HANGUPERROR when ERROR;
}

State TOOATTEMPTS {
	Say "Disculpe, pero estamos teniendo problemas para entender. Si es tan amable intentelo mas tarde";
}

State HANGUPERROR {
	Say "Ha ocurrido un error, disculpe las molestias.";
	HangUp;
}
   

State END {
	Say "De acuerdo. Gracias por utilizar nuestro servicio de restaurantes Telcodev. Un saludo.";
	//Send { "caller": CALLER, "day": day, "hour": hour, "month": month, "people": people} to "http://s.com";
	if(CALLER==usernumber){
		Email{subject : "Reservation",
		from :"restaurant@dime.com",
		message : 'Usted ha solicitado una reserva en nuestro restaurante el dia '.day.'de'.month.'de'.year.'a las '.hour." para".people.' personas'
	} to userEmail;
	Send { "caller": usernumber, "day": day, "hour": hour, "month": month, "people": people, "year":year} to "http://s.com";
	}
	
	HangUp;
}